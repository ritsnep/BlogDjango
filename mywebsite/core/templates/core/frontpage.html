{% extends 'core/base.html' %}
{% block title %}
Home |
{% endblock %}
{% block content %}

<style>
    .homepage-container {
        max-width: 1440px;
        margin: 0 auto;
        padding: 2rem 1rem;
    }

    /* Widen container */
    .section>.container {
        max-width: 1440px;
    }

    /* TOP SECTION */
    .top-section {
        display: grid;
        grid-template-columns: 1.2fr 1fr 0.6fr;
        gap: 2.5rem;
        margin-bottom: 3rem;
    }

    .featured-article {
        display: flex;
        flex-direction: column;
    }

    .featured-label {
        font-size: 1.05rem;
        font-weight: 900;
        letter-spacing: 0.6px;
        color: #0b1628;
        margin-bottom: 0.8rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid #cfd6e0;
        /* slightly thinner and lighter */
        text-transform: uppercase;
    }

    .featured-image {
        width: 100%;
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .featured-image img {
        width: 100%;
        height: 360px;
        object-fit: cover;
    }

    .featured-content h1 {
        font-size: 2rem;
        margin: 0 0 1rem 0;
        line-height: 1.3;
        font-weight: bold;
        color: #0b1628;
    }

    .featured-content p {
        font-family: 'Lora', serif;
        color: #4b5563;
        line-height: 1.6;
        margin: 1rem 0;
        font-size: 1.05rem;
    }

    .featured-meta {
        font-size: 0.85rem;
        color: #6b7280;
        margin-top: 0.75rem;
        display: flex;
        align-items: center;
        gap: .75rem;
        flex-wrap: wrap;
    }

    .meta-piece {
        display: inline-flex;
        align-items: center;
        gap: .35rem;
    }

    .meta-piece i {
        color: #9aa7b7;
    }

    .featured-author {
        font-weight: 600;
        color: #333;
    }

    a {
        text-decoration: none;
        color: inherit;
    }

    a:hover {
        color: #3273dc;
    }

    .featured-content a:hover h1 {
        color: #3273dc;
    }

    /* Latest News */
    .latest-news {
        display: flex;
        flex-direction: column;
    }

    /* Promo card */
    .ad-card {
        border: 1px solid #e5e9f0;
        border-radius: 10px;
        background: #ffffff;
        padding: 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.6rem;
        box-shadow: 0 4px 14px rgba(16, 24, 40, 0.06);
    }

    .ad-card .ad-badge {
        font-size: 0.62rem;
        font-weight: 800;
        color: #0860c0;
        background: #e6f1ff;
        padding: 0.18rem 0.5rem;
        border-radius: 999px;
        align-self: flex-start;
        letter-spacing: .35px;
        text-transform: uppercase;
    }

    .article-card-info h3 {
        font-family: 'Montserrat', sans-serif;
        font-size: 1.1rem;
        font-weight: 800;
        color: #0b1628;
        margin: 0.4rem 0 0.6rem 0;
        line-height: 1.35;
    }

    .article-card-info p {
        font-family: 'Lora', serif;
        font-size: 0.95rem;
        color: #475569;
        line-height: 1.55;
        margin-bottom: 0.8rem;
    }

    .ad-card .ad-cta {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.4rem;
        margin-top: 0.6rem;
        padding: 0.6rem 1rem;
        border-radius: 8px;
        background: #3b82f6;
        color: #fff;
        font-weight: 800;
        font-size: 0.9rem;
        text-align: center;
        transition: background .2s ease, transform .06s ease;
    }

    .ad-card .ad-cta i {
        font-size: 0.9rem;
    }

    .ad-card .ad-cta:hover {
        background: #2563eb;
    }

    .ad-card .ad-cta:active {
        transform: translateY(1px);
    }

    /* Promo column */
    .promo-column {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .ad-card-dark {
        border: 1px solid #0f172a;
        border-radius: 8px;
        background: #0f172a;
        padding: 1rem;
        color: #e5e7eb;
    }

    .ad-card-dark h4 {
        margin: 0 0 .5rem 0;
        font-weight: 800;
        font-size: 1rem;
        color: #fff;
    }

    .ad-card-dark p {
        margin: 0 0 .75rem 0;
        font-size: .9rem;
        color: #cbd5e1;
    }

    .ad-card-dark .ad-cta {
        display: inline-block;
        background: #22c55e;
        color: #052e1b;
        font-weight: 800;
        padding: .55rem .9rem;
        border-radius: 6px;
    }

    .ad-card-dark .ad-cta:hover {
        background: #16a34a;
    }

    /* Newsletter card */
    .ad-card-dark.ad-newsletter {
        background-color: #24223d;
        /* Precise dark navy from image */
        border: none;
        padding: 1.1rem 1.1rem;
        /* Reduced padding */
        border-radius: 10px;
        position: relative;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .ad-card-dark.ad-newsletter .ad-title {
        font-weight: 900;
        color: #fff;
        font-size: 1rem;
        /* Smaller Font */
        margin: 0;
        line-height: 1.25;
    }

    .ad-card-dark.ad-newsletter .ad-title span {
        color: #00e676;
    }

    /* Green highlight */

    .ad-card-dark.ad-newsletter .ad-subtitle {
        font-weight: 900;
        color: #fff;
        font-size: 1rem;
        /* Smaller Font */
        margin: 0.1rem 0 0.8rem;
        line-height: 1.25;
    }

    .ad-card-dark.ad-newsletter .ad-desc {
        color: #cbd5e1;
        font-size: 0.9rem;
        /* Smaller Font */
        line-height: 1.5;
        margin-bottom: 1rem;
        font-weight: 500;
        opacity: 0.9;
    }

    .ad-card-dark .ad-icon-wrap {
        position: absolute;
        right: 15px;
        top: 15px;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .ad-card-dark .ad-icon {
        color: #fff;
        font-size: 1.3rem;
    }

    .ad-card-dark .ad-icon-wrap::after {
        content: '';
        position: absolute;
        top: 2px;
        right: -2px;
        width: 8px;
        height: 8px;
        background: #00e676;
        border-radius: 50%;
        border: 2px solid #24223d;
    }

    .ad-newsletter .ad-input-group {
        display: flex;
        background: #fff;
        border-radius: 8px;
        overflow: hidden;
        padding: 4px;
        width: 100%;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .ad-newsletter .ad-input-group input {
        flex: 1;
        border: 0;
        background: transparent;
        color: #333;
        padding: 0.5rem 0.75rem;
        font-size: 0.9rem;
        outline: none;
        min-width: 0;
    }

    .ad-newsletter .ad-input-group input::placeholder {
        color: #94a3b8;
    }

    .ad-newsletter .ad-input-group button {
        border: 0;
        background: #00c0a5;
        color: #fff;
        font-weight: 800;
        padding: 0 1rem;
        height: 40px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9rem;
        white-space: nowrap;
        transition: background 0.2s ease;
    }

    .ad-newsletter .ad-input-group button:hover {
        background: #00a891;
    }

    .news-label {
        font-size: 1.05rem;
        font-weight: 900;
        letter-spacing: 0.6px;
        color: #0b1628;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid #cfd6e0;
        /* slightly thinner and lighter */
        text-transform: uppercase;
    }

    .news-list {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .news-item {
        display: grid;
        grid-template-columns: 100px 1fr;
        gap: 1rem;
        padding: 0.9rem 0 1.3rem 0;
        border-bottom: 1px solid #cfd6e0;
        /* lighter separator */
    }

    .news-item:last-child {
        border-bottom: none;
        padding-bottom: 0;
    }

    .news-item-image {
        width: 100px;
        height: 75px;
        border-radius: 4px;
        overflow: hidden;
    }

    .news-item-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .news-item-content h3 {
        font-family: 'Montserrat', sans-serif;
        font-size: 1rem;
        font-weight: 800;
        margin: 0 0 0.35rem 0;
        line-height: 1.35;
        color: #0b1628;
    }

    .news-item-meta {
        font-size: 0.8rem;
        color: #6b7280;
        display: inline-flex;
        align-items: center;
        gap: .35rem;
    }

    .category-tag {
        display: inline-block;
        font-size: 0.7rem;
        color: #6b7280;
        margin-right: 0.5rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: .5px;
        background: transparent;
        border: none;
        padding: 0;
    }

    /* BOTTOM SECTION */
    .bottom-section {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2.5rem;
    }

    .articles-column {
        display: flex;
        flex-direction: column;
    }

    .column-label {
        font-size: 1.15rem;
        font-weight: 900;
        letter-spacing: 0.8px;
        color: #1a202c;
        margin-bottom: 1.5rem;
        text-transform: uppercase;
        display: block;
    }

    /* Removed dash prefix */

    .articles-list {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    /* Add a separator after lists that show a See All Articles button */
    .articles-list.with-separator {
        border-bottom: 1px solid #cfd6e0;
        padding-bottom: 1rem;
        margin-bottom: 0.5rem;
    }

    .article-row {
        display: grid;
        grid-template-columns: 120px 1fr;
        gap: 1rem;
        padding: 0.9rem 0 1.3rem 0;
        border-bottom: 1px solid #cfd6e0;
        /* lighter separator */
    }

    .article-row:last-child {
        border-bottom: none;
        padding-bottom: 0;
    }

    .article-row-image {
        width: 130px;
        height: 75px;
        border-radius: 4px;
        overflow: hidden;
    }

    .article-row-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .article-row-content h3 {
        font-family: 'Montserrat', sans-serif;
        font-size: 1.05rem;
        font-weight: 800;
        margin: 0 0 0.3rem 0;
        line-height: 1.35;
        color: #0b1628;
    }

    .article-row-meta {
        font-size: 0.8rem;
        color: #6b7280;
        display: flex;
        gap: 0.75rem;
        margin-top: 0.3rem;
        align-items: center;
        flex-wrap: wrap;
    }

    .article-row-content .category-tag {
        margin-bottom: 0.3rem;
        display: inline-block;
    }

    .see-all-button {
        display: inline-block;
        margin-top: 2.5rem;
        padding: 0.7rem 1.4rem;
        border: 1px solid #cdd6e1;
        border-radius: 6px;
        background: #fff;
        color: #0b1628;
        font-size: 0.85rem;
        font-weight: 800;
        cursor: pointer;
        transition: all 0.3s;
        text-align: center;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .see-all-button:hover {
        border-color: #94b8ff;
        color: #1d4ed8;
        background: #f8fbff;
    }

    .see-all-button:hover i {
        transform: translateX(5px);
    }

    .trending-label::before {
        display: none;
    }

    /* GUIDES SECTION */
    .guides-section {
        margin: 4rem 0;
        padding-top: 3rem;
        border-top: 2px solid #f0f0f0;
    }

    .section-title {
        font-family: 'Montserrat', sans-serif;
        font-size: 1.8rem;
        font-weight: 800;
        margin-bottom: 2rem;
        color: #1a1a1a;
    }

    .section-title span {
        color: #3273dc;
    }

    .category-tabs {
        display: flex;
        gap: 1.5rem;
        margin-bottom: 2.5rem;
        border-bottom: 1px solid #eee;
        padding-bottom: 0.5rem;
    }

    .tab-item {
        font-size: 0.85rem;
        font-weight: 700;
        text-transform: uppercase;
        color: #888;
        cursor: pointer;
        transition: all 0.3s;
        border-bottom: 2px solid transparent;
        padding-bottom: 0.5rem;
        margin-bottom: -0.6rem;
    }

    .tab-item:hover,
    .tab-item.active {
        color: #333;
        border-bottom-color: #333;
    }

    .guides-grid {
        display: none;
        grid-template-columns: repeat(3, 1fr);
        gap: 2rem;
        animation: fadeIn 0.4s ease-in-out;
    }

    .guides-grid.active {
        display: grid;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .guide-card {
        display: flex;
        flex-direction: column;
    }

    .guide-card-image {
        width: 100%;
        height: 180px;
        border-radius: 6px;
        overflow: hidden;
        margin-top: 1rem;
    }

    .guide-card-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .guide-card h3 {
        font-size: 1.1rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        line-height: 1.4;
    }

    /* EXPERT SECTION */
    .expert-section {
        display: grid;
        grid-template-columns: 1fr 1.2fr;
        align-items: center;
        gap: 3rem;
        margin: 6rem 0;
        background: linear-gradient(135deg, #f0f7ff 0%, #f5f3ff 100%);
        padding: 4rem 3rem;
        border-radius: 16px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.5);
    }

    .expert-content h4 {
        text-transform: uppercase;
        font-size: 0.75rem;
        font-weight: 700;
        color: #666;
        margin-bottom: 1rem;
    }

    .expert-content h2 {
        font-size: 2.2rem;
        font-weight: 800;
        margin-bottom: 1.5rem;
    }

    .expert-content p {
        color: #555;
        line-height: 1.6;
        margin-bottom: 2rem;
    }

    .expert-stats {
        display: flex;
        gap: 3rem;
    }

    .stat-item h3 {
        font-size: 1.5rem;
        font-weight: 800;
        color: #3273dc;
        margin-bottom: 0.2rem;
    }

    .stat-item p {
        font-size: 0.7rem;
        text-transform: uppercase;
        font-weight: 700;
        color: #777;
    }

    .expert-images {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
        position: relative;
    }

    .expert-img {
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .expert-img img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .large-expert {
        grid-column: span 2;
        grid-row: span 2;
    }

    /* NEWSLETTER SECTION */
    .newsletter-full {
        background: #1a1c2e;
        color: white;
        padding: 5rem 2rem;
        text-align: center;
        margin: 4rem -50vw;
        position: relative;
        left: 50%;
        right: 50%;
        width: 100vw;
        box-sizing: border-box;
    }

    .newsletter-full h2 {
        font-size: 2rem;
        font-weight: 800;
        margin-bottom: 1rem;
    }

    .newsletter-full p {
        color: #a0a0c0;
        margin-bottom: 2.5rem;
    }

    .newsletter-form-wide {
        display: flex;
        max-width: 600px;
        margin: 0 auto;
        gap: 0;
    }

    .newsletter-form-wide input {
        flex-grow: 1;
        padding: 1rem 1.5rem;
        border: none;
        border-radius: 4px 0 0 4px;
        font-size: 1rem;
    }

    .newsletter-form-wide button {
        background: #3273dc;
        color: white;
        border: none;
        padding: 1rem 2rem;
        font-weight: 700;
        border-radius: 0 4px 4px 0;
        cursor: pointer;
        font-size: 1rem;
        line-height: normal;
    }

    .newsletter-features {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-top: 3rem;
        font-size: 0.85rem;
        color: #ccc;
        flex-wrap: wrap;
    }

    .n-feat i {
        color: #3273dc;
        margin-right: 0.5rem;
    }

    /* TOP CATEGORY ARTICLES */
    .top-articles-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 4rem;
        margin: 5rem 0;
    }

    .top-articles-col h2 {
        font-size: 0.9rem;
        text-transform: uppercase;
        font-weight: 800;
        color: #333;
        margin-bottom: 2rem;
        border-bottom: 2px solid #333;
        padding-bottom: 0.5rem;
        display: inline-block;
    }

    @media (max-width: 768px) {

        /* Homepage container padding adjustment */
        .homepage-container {
            padding: 1rem 0.75rem;
        }

        /* Top section - Featured + Latest News */
        .top-section {
            grid-template-columns: 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .featured-image img {
            height: 230px;
        }

        .featured-content h1 {
            font-size: 1.6rem;
            line-height: 1.4;
        }

        .featured-content p {
            font-size: 0.9rem;
        }

        .news-label,
        .featured-label {
            font-size: 0.7rem;
            margin-bottom: 1rem;
        }

        .news-item {
            grid-template-columns: 80px 1fr;
            gap: 0.75rem;
            padding-bottom: 1rem;
        }

        .news-item-image {
            width: 80px;
            height: 60px;
        }

        .news-item-content h3 {
            font-size: 0.85rem;
        }

        .news-item-meta {
            font-size: 0.75rem;
        }

        /* Bottom section - Recent + Trending */
        .bottom-section {
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        .column-label {
            font-size: 0.7rem;
            margin-bottom: 1rem;
        }

        .article-row {
            grid-template-columns: 100px 1fr;
            gap: 0.75rem;
            padding-bottom: 1rem;
        }

        .article-row-image {
            width: 100px;
            height: 65px;
        }

        .article-row-content h3 {
            font-size: 0.95rem;
        }

        .article-row-meta {
            font-size: 0.7rem;
        }

        .category-tag {
            font-size: 0.65rem;
            padding: 0.2rem 0.4rem;
        }

        .see-all-button {
            margin-top: 1.5rem;
            padding: 0.7rem 1.5rem;
            font-size: 0.85rem;
        }

        /* Guides section */
        .guides-section {
            margin: 3rem 0;
            padding-top: 2rem;
        }

        .section-title {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            line-height: 1.4;
        }

        .section-title br {
            display: none;
        }

        .category-tabs {
            gap: 1rem;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .category-tabs::-webkit-scrollbar {
            display: none;
        }

        .tab-item {
            font-size: 0.75rem;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .guides-grid,
        .expert-section,
        .top-articles-grid {
            grid-template-columns: 1fr;
        }

        .guide-card-image {
            height: 150px;
        }

        .guide-card h3 {
            font-size: 1rem;
        }

        /* Expert section */
        .expert-section {
            grid-template-columns: 1fr;
            text-align: left;
            margin: 3rem 0;
            padding: 2rem 1.5rem;
        }

        .expert-content h4 {
            font-size: 0.7rem;
        }

        .expert-content h2 {
            font-size: 1.6rem;
            margin-bottom: 1rem;
        }

        .expert-content p {
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
        }

        .expert-stats {
            gap: 2rem;
            flex-wrap: wrap;
        }

        .stat-item h3 {
            font-size: 1.3rem;
        }

        .stat-item p {
            font-size: 0.65rem;
        }

        .expert-images {
            height: auto !important;
            margin: 3rem 0;
            display: flex !important;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
        }

        .expert-img {
            position: static !important;
            width: 100px !important;
            height: 100px !important;
        }

        /* Newsletter section */
        .newsletter-form-wide {
            flex-direction: column;
            gap: 1rem;
        }

        .newsletter-form-wide input,
        .newsletter-form-wide button {
            border-radius: 4px;
            width: 100%;
            padding: 1rem 1.5rem;
            box-sizing: border-box;
        }

        .newsletter-full {
            margin: 4rem 0;
            width: 100%;
            left: 0;
            right: 0;
            padding: 3rem 1.5rem;
        }

        .newsletter-full h2 {
            font-size: 1.4rem;
            line-height: 1.3;
        }

        .newsletter-full h2 br {
            display: none;
        }

        .newsletter-full p {
            font-size: 0.9rem;
            margin-bottom: 2rem;
        }

        .newsletter-features {
            gap: 1rem;
            flex-direction: column;
            align-items: flex-start;
            max-width: 300px;
            margin: 2.5rem auto 0;
            font-size: 0.8rem;
        }

        /* Top articles section */
        .top-articles-grid {
            gap: 3rem;
            margin: 3rem 0;
        }

        .top-articles-col h2 {
            font-size: 0.8rem;
            margin-bottom: 1.5rem;
        }
    }

    /* frontpage overflow fixes */
    .promo-column,
    .ad-card,
    .ad-card-dark {
        max-width: 100%;
        box-sizing: border-box;
    }

    .ad-card,
    .ad-card-dark {
        overflow: hidden;
    }

    .ad-newsletter .ad-input-group {
        max-width: 100%;
    }

    .ad-newsletter .ad-input-group input {
        min-width: 0;
    }

    @media (max-width: 768px) {

        .ad-card,
        .ad-card-dark {
            padding: 1rem;
            width: 100%;
        }

        .ad-newsletter .ad-input-group {
            display: flex;
            flex-wrap: wrap;
        }

        .ad-newsletter .ad-input-group button {
            width: 100%;
            margin-top: 0.5rem;
        }
    }

    @media (max-width: 480px) {
        .ad-newsletter .ad-input-group {
            flex-wrap: wrap;
        }

        .ad-newsletter .ad-input-group button {
            width: 100%;
            margin-top: 0.5rem;
        }

        .top-section,
        .latest-news,
        .promo-column {
            width: 100%;
            max-width: 100%;
        }
    }

    /* Ensure no horizontal overflow from nested elements */
    .homepage-container,
    .top-section,
    .latest-news,
    .promo-column,
    .news-list {
        overflow-x: hidden;
    }

    .ad-newsletter .ad-input-group,
    .ad-newsletter .ad-input-group * {
        box-sizing: border-box;
    }

    .ad-newsletter .ad-input-group {
        width: 100%;
    }

    .ad-newsletter .ad-input-group input {
        flex: 1 1 auto;
        min-width: 0;
    }

    .news-item {
        min-width: 0;
    }

    .ad-card *,
    .ad-card-dark * {
        max-width: 100%;
    }

    .ad-card img,
    .ad-card-dark img {
        width: 100%;
        height: auto;
    }
</style>

<div class="homepage-container">
    <!-- TOP SECTION: Featured Article + Latest News -->
    <div class="top-section">
        <!-- FEATURED ARTICLE -->
        <div class="featured-article">
            {% if featured_post %}
            <div class="featured-label">Featured Article</div>
            <div class="featured-image">
                {% if featured_post.image %}
                <img src="{{ featured_post.get_image_url }}" alt="{{ featured_post.title }}">
                {% else %}
                <div
                    style="width: 100%; height: 300px; background: #e0e0e0; display: flex; align-items: center; justify-content: center;">
                    <span style="color: #999;">No Image</span>
                </div>
                {% endif %}
            </div>
            <div class="featured-content">
                <div class="category-tag">{{ featured_post.category.title }}</div>
                <a href="{% url 'post_detail' featured_post.category.slug featured_post.slug %}">
                    <h1>{{ featured_post.title }}</h1>
                </a>
                <p>{{ featured_post.intro }}</p>
                <div class="featured-meta">{{ featured_post.author.get_full_name|default:featured_post.author.username }} • {{ featured_post.created_at|date:"M d, Y" }}</div>
            </div>
            {% endif %}
        </div>

        <!-- LATEST NEWS -->
        <div class="latest-news">
            <div class="news-label">Latest News</div>
            <div class="news-list">
                {% if latest_posts %}
                {% for post in latest_posts %}
                <a href="{% url 'post_detail' post.category.slug post.slug %}" class="news-item">
                    <div class="news-item-image">
                        {% if post.image %}
                        <img src="{{ post.get_image_url }}" alt="{{ post.title }}">
                        {% else %}
                        <div
                            style="width: 100%; height: 75px; background: #e0e0e0; display: flex; align-items: center; justify-content: center;">
                            <span style="color: #999; font-size: 0.7rem;">No Image</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="news-item-content">
                        <div class="category-tag">{{ post.category.title }}</div>
                        <h3>{{ post.title }}</h3>
                        <div class="news-item-meta">{{ post.author.get_full_name|default:post.author.username }} • {{ post.created_at|date:"M d, Y" }}</div>
                    </div>
                </a>
                {% endfor %}
                {% endif %}
            </div>
        </div>
        <!-- PROMO COLUMN -->
        <div class="promo-column">
            <div class="ad-card">
                <span class="ad-badge">Sponsored</span>
                <h4>Analyze rival marketing strategies</h4>
                <p>Uncover competitors’ top pages, keywords and backlinks to power your content and SEO plans.</p>
                <a class="ad-cta" href="#">Try It Free <i class="fa fa-arrow-right"></i></a>
            </div>
            <div class="ad-card-dark ad-newsletter">
                <div class="ad-icon-wrap">
                    <i class="fa fa-envelope-o ad-icon" aria-hidden="true"></i>
                </div>
                <div class="ad-title">Latest News And <span>Insights</span></div>
                <div class="ad-subtitle">Delivered To Your Inbox</div>
                <p class="ad-desc">Get your daily recap of the latest search news, advice, and trends.</p>
                <div class="ad-input-group">
                    <input type="email" placeholder="Enter your email here." aria-label="Email address">
                    <button type="button">Sign Me Up!</button>
                </div>
            </div>
        </div>
    </div>

    <!-- BOTTOM SECTION: Recent Articles + Trending Articles -->
    <div class="bottom-section">
        <!-- RECENT ARTICLES -->
        <div class="articles-column">
            <div class="column-label">Recent Articles</div>
            <div class="articles-list with-separator">
                {% if recent_posts %}
                {% for post in recent_posts %}
                <a href="{% url 'post_detail' post.category.slug post.slug %}" class="article-row">
                    <div class="article-row-image">
                        {% if post.image %}
                        <img src="{{ post.get_image_url }}" alt="{{ post.title }}">
                        {% else %}
                        <div
                            style="width: 100%; height: 90px; background: #e0e0e0; display: flex; align-items: center; justify-content: center;">
                            <span style="color: #999; font-size: 0.7rem;">No Image</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="article-row-content">
                        <div class="category-tag">{{ post.category.title }}</div>
                        <h3>{{ post.title }}</h3>
                        <div class="article-row-meta">{{ post.author.get_full_name|default:post.author.username }} • {{ post.created_at|date:"M d, Y" }}</div>
                    </div>
                </a>
                {% endfor %}
                {% endif %}
            </div>
            <a href="{% url 'all_recent' %}" class="see-all-button">SEE ALL ARTICLES</a>
        </div>

        <!-- TRENDING ARTICLES -->
        <div class="articles-column">
            <div class="column-label trending-label">Trending Articles</div>
            <div class="articles-list with-separator">
                {% if trending_posts %}
                {% for post in trending_posts %}
                <a href="{% url 'post_detail' post.category.slug post.slug %}" class="article-row">
                    <div class="article-row-image">
                        {% if post.image %}
                        <img src="{{ post.get_image_url }}" alt="{{ post.title }}">
                        {% else %}
                        <div
                            style="width: 100%; height: 90px; background: #e0e0e0; display: flex; align-items: center; justify-content: center;">
                            <span style="color: #999; font-size: 0.7rem;">No Image</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="article-row-content">
                        <div class="category-tag">{{ post.category.title }}</div>
                        <h3>{{ post.title }}</h3>
                        <div class="article-row-meta">{{ post.author.get_full_name|default:post.author.username }} • {{ post.created_at|date:"M d, Y" }}</div>
                    </div>
                </a>
                {% endfor %}
                {% endif %}
            </div>
            <a href="{% url 'all_trending' %}" class="see-all-button">SEE ALL ARTICLES</a>
        </div>
    </div>

    <!-- NEW GUIDES SECTION -->
    <div class="guides-section">
        <h2 class="section-title"><span>Complete guides</span> for every stage of<br>your search marketing career.</h2>

        <div class="category-tabs">
            {% for item in guides_data %}
            <div class="tab-item {% if forloop.first %}active{% endif %}" data-target="guide-{{ item.category.slug }}"
                data-title="{{ item.category.title }}" data-url="{% url 'category_detail' item.category.slug %}">
                {{ item.category.title }}
            </div>
            {% endfor %}
        </div>

        {% for item in guides_data %}
        <div class="guides-grid {% if forloop.first %}active{% endif %}" id="guide-{{ item.category.slug }}">
            {% for post in item.posts %}
            <a href="{% url 'post_detail' post.category.slug post.slug %}" class="guide-card">
                <h3>{{ post.title }}</h3>
                <div class="guide-card-image">
                    {% if post.image %}
                    <img src="{{ post.get_image_url }}" alt="{{ post.title }}">
                    {% else %}
                    <div
                        style="width: 100%; height: 100%; background: #e0e0e0; display: flex; align-items: center; justify-content: center;">
                        <span style="color: #999;">No Image</span>
                    </div>
                    {% endif %}
                </div>
            </a>
            {% empty %}
            <div
                style="grid-column: span 3; padding: 2rem; background: #f9f9f9; border-radius: 8px; text-align: center;">
                <p style="color: #888;">No guides available for <strong>{{ item.category.title }}</strong> yet.</p>
            </div>
            {% endfor %}
        </div>
        {% endfor %}

        <!-- Unified Dynamic Button (outside the switching grids) -->
        {% if guides_data %}
        <div style="text-align: left; width: 100%; margin-top: 3rem;">
            <a id="guides-dynamic-btn" href="{% url 'category_detail' guides_data.0.category.slug %}"
                class="see-all-button">
                View All {{ guides_data.0.category.title }}
            </a>
        </div>
        {% endif %}

        <script>
            document.querySelectorAll('.tab-item').forEach(tab => {
                tab.addEventListener('click', function () {
                    const targetId = this.getAttribute('data-target');
                    const targetGrid = document.getElementById(targetId);

                    if (!targetGrid) return;

                    // 1. Reset all active states and HIDE all grids explicitly
                    document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.guides-grid').forEach(g => {
                        g.classList.remove('active');
                        g.style.display = 'none'; // Force hide
                    });

                    // 2. Activate selected tab and grid
                    this.classList.add('active');
                    targetGrid.classList.add('active');
                    targetGrid.style.display = 'grid'; // Force show

                    // 3. Update the dynamic button
                    const btn = document.getElementById('guides-dynamic-btn');
                    const title = this.getAttribute('data-title');
                    const url = this.getAttribute('data-url');

                    if (btn && title && url) {
                        btn.innerText = `View All ${title}`;
                        btn.href = url;
                    }
                });
            });
        </script>

    </div>

    <!-- NEW EXPERT SESSION -->
    <div class="expert-section">
        <div class="expert-content">
            <h4>Industry Authority</h4>
            <h2>The industry's most trusted source</h2>
            <p>Industry-leading insights that keep search marketing professionals ahead of algorithm changes and market
                shifts. Our team of specialists provides deep-dive analysis into the trends that matter most.</p>

            <div class="expert-stats">
                <div class="stat-item">
                    <h3>90+</h3>
                    <p>Industry Contributors</p>
                </div>
                <div class="stat-item">
                    <h3>50K+</h3>
                    <p>Verified Insights</p>
                </div>
                <div class="stat-item">
                    <h3>1.5M</h3>
                    <p>Monthly Audience</p>
                </div>
            </div>

            <div style="text-align: left;">
                <a href="{% url 'meet_the_team' %}" class="see-all-button" style="margin-top: 2rem;">
                    Meet The Team <i class="fa fa-arrow-right"
                        style="margin-left: 0.5rem; transition: transform 0.3s;"></i>
                </a>
            </div>

        </div>

        <div class="expert-images"
            style="position: relative; height: 420px; width: 100%; max-width: 500px; margin-left: auto;">
            <!-- expert-img 1: Top Left -->
            <div class="expert-img"
                style="position: absolute; top: 0; right: 120px; width: 160px; height: 160px; z-index: 2; border-radius: 4px; border: 4px solid white;">
                <img src="https://secure.gravatar.com/avatar/9e60d3b1cd78df2a625cf00ceec2ff5239d1facc83e5965d6c00c8e23f75302f?s=240&d=mm&r=g"
                    alt="Team Member1">
            </div>
            <!-- expert-img 2: Top Right -->
            <div class="expert-img"
                style="position: absolute; top: 20px; right: 0; width: 140px; height: 140px; z-index: 1; border-radius: 4px; border: 4px solid white;">
                <img src="https://images.unsplash.com/photo-1568602471122-7832951cc4c5?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
                    alt="Team Member2">
            </div>
            <!-- expert-img 3: MAIN Center -->
            <div class="expert-img"
                style="position: absolute; top: 180px; right: 100px; width: 200px; height: 200px; z-index: 4; border-radius: 4px; border: 6px solid white;">
                <img src="https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?auto=format&fit=crop&w=500&q=80"
                    alt="Team Member3">
            </div>
            <!-- expert-img 4: Middle Right -->
            <div class="expert-img"
                style="position: absolute; top: 200px; right: 0; width: 140px; height: 140px; z-index: 2; border-radius: 4px; border: 4px solid white;">
                <img src="https://images.unsplash.com/photo-1580489944761-15a19d654956?auto=format&fit=crop&w=300&q=80"
                    alt="Team Member4">
            </div>
            <!-- expert-img 5: Bottom Left -->
            <div class="expert-img"
                style="position: absolute; top: 160px; left: 20px; width: 130px; height: 130px; z-index: 1; border-radius: 4px; border: 4px solid white;">
                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=300&q=80"
                    alt="Team Member5">
            </div>
            <!-- expert-img 6: Bottom Float -->
            <div class="expert-img"
                style="position: absolute; top: 100px; left: 80px; width: 80px; height: 80px; z-index: 1; border-radius: 4px; border: 2px solid white;">
                <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=200&q=80"
                    alt="Team Member6">
            </div>
        </div>
    </div>

    <!-- NEW NEWSLETTER SECTION -->
    <div class="newsletter-full">
        <h2>The industry's trusted source for<br>essential news and analysis.</h2>
        <p>Sign up for our newsletter to receive exclusive insights and updates directly to your inbox.</p>

        <div class="newsletter-form-wide">
            <input type="email" placeholder="Enter your email here" required>
            <button type="button">Sign Me Up!</button>
        </div>

        <div class="newsletter-features">
            <span class="n-feat"><i class="fa fa-check-circle"></i> Daily breaking news</span>
            <span class="n-feat"><i class="fa fa-check-circle"></i> Expert analysis from industry veterans</span>
            <span class="n-feat"><i class="fa fa-check-circle"></i> Join over 200k subscribers</span>
            <span class="n-feat"><i class="fa fa-check-circle"></i> Covering SEO, PPC and AI</span>
        </div>
    </div>

    <!-- NEW TOP ARTICLES SECTION -->
    <div class="top-articles-grid">
        <!-- TOP SEO ARTICLES -->
        <div class="top-articles-col">
            <h2>Top {% if seo_cat %}{{ seo_cat.title }}{% else %}SEO{% endif %} Articles</h2>
            <div class="articles-list with-separator">
                {% for post in seo_posts %}
                <a href="{% url 'post_detail' post.category.slug post.slug %}" class="article-row">
                    <div class="article-row-image">
                        {% if post.image %}
                        <img src="{{ post.get_image_url }}" alt="{{ post.title }}">
                        {% endif %}
                    </div>
                    <div class="article-row-content">
                        <div class="category-tag">SEO</div>
                        <h3>{{ post.title }}</h3>
                        <div class="article-row-meta">{{ post.author.get_full_name|default:post.author.username }} • {{ post.created_at|date:"M d, Y" }}</div>
                    </div>
                </a>
                {% endfor %}
            </div>
            {% if seo_cat %}
            <div style="margin-top: 2.5rem; text-align: left;">
                <a href="{% url 'category_detail' seo_cat.slug %}" class="see-all-button">SEE ALL ARTICLES</a>
            </div>
            {% endif %}
        </div>

        <!-- TOP DIGITAL MARKETING ARTICLES -->
        <div class="top-articles-col">
            <h2>Top {% if dm_cat %}{{ dm_cat.title }}{% else %}Digital Marketing{% endif %} Articles</h2>
            <div class="articles-list with-separator">
                {% for post in dm_posts %}
                <a href="{% url 'post_detail' post.category.slug post.slug %}" class="article-row">
                    <div class="article-row-image">
                        {% if post.image %}
                        <img src="{{ post.get_image_url }}" alt="{{ post.title }}">
                        {% endif %}
                    </div>
                    <div class="article-row-content">
                        <div class="category-tag">Digital Marketing</div>
                        <h3>{{ post.title }}</h3>
                        <div class="article-row-meta">{{ post.author.get_full_name|default:post.author.username }} • {{ post.created_at|date:"M d, Y" }}</div>
                    </div>
                </a>
                {% endfor %}
            </div>
            {% if dm_cat %}
            <div style="margin-top: 2.5rem; text-align: left;">
                <a href="{% url 'category_detail' dm_cat.slug %}" class="see-all-button">SEE ALL ARTICLES</a>
            </div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}